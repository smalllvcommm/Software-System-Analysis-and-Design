# 个人信息管理系统设计报告（第2部分）
## 面向对象分析与设计

---

## 4. 面向对象分析模型

### 4.1 领域模型类图（概念层）

```
┌─────────────────────────────────────────────────────────────────┐
│                      领域模型类图                                  │
└─────────────────────────────────────────────────────────────────┘

                    ┌──────────────┐
                    │     User     │
                    ├──────────────┤
                    │ -username    │
                    │ -password    │
                    │ -email       │
                    │ -role        │
                    └──────────────┘

    ┌──────────────┐                      ┌──────────────┐
    │   Category   │◄─────────────────────│     Info     │
    ├──────────────┤                      ├──────────────┤
    │ -name        │         *         1  │ -title       │
    │ -description │                      │ -content     │
    └──────────────┘                      │ -createdTime │
                                          │ -updatedTime │
                                          └──────┬───────┘
                                                 │
                      ┌──────────────┐          │
                      │      Tag     │◄─────────┤
                      ├──────────────┤  *    *  │
                      │ -name        │          │
                      │ -color       │          │
                      └──────────────┘          │
                                                 │
         ┌───────────────────────────────────────┴───────────────────────────┐
         │              │            │            │          │         │      │
         ▼              ▼            ▼            ▼          ▼         ▼      ▼
    ┌─────────┐   ┌─────────┐  ┌─────────┐  ┌────────┐ ┌───────┐ ┌──────┐  ...
    │ Article │   │  Diary  │  │  Todo   │  │  Memo  │ │ Audio │ │Video │
    ├─────────┤   ├─────────┤  ├─────────┤  ├────────┤ ├───────┤ ├──────┤
    │-summary │   │ -mood   │  │ -status │  │ -type  │ │ -url  │ │ -url │
    │-author  │   │-weather │  │-priority│  │        │ │-duration│ │-duration│
    │-status  │   │ -date   │  │-deadline│  │        │ └───────┘ └──────┘
    └─────────┘   └─────────┘  └─────────┘  └────────┘

    其他实体类：Website、Expense、TravelPlan、StudyCheckIn
```

### 4.2 关键业务用例分析

#### 4.2.1 用例：创建文章

**分析类结构**：
- **边界类**：ArticleEditPage（文章编辑页面）
- **控制类**：ArticleController（文章控制器）
- **实体类**：Article、Category、Tag

**系统时序图**：

```
用户          ArticleEditPage    ArticleController    ArticleService    ArticleRepository
 │                  │                    │                  │                  │
 │  1.输入文章信息   │                    │                  │                  │
 ├─────────────────►│                    │                  │                  │
 │                  │                    │                  │                  │
 │  2.点击保存       │                    │                  │                  │
 ├─────────────────►│                    │                  │                  │
 │                  │                    │                  │                  │
 │                  │  3.创建文章请求     │                  │                  │
 │                  ├───────────────────►│                  │                  │
 │                  │                    │                  │                  │
 │                  │                    │  4.验证并创建文章  │                  │
 │                  │                    ├─────────────────►│                  │
 │                  │                    │                  │                  │
 │                  │                    │                  │  5.保存到数据库   │
 │                  │                    │                  ├─────────────────►│
 │                  │                    │                  │                  │
 │                  │                    │                  │  6.返回文章实体   │
 │                  │                    │                  │◄─────────────────┤
 │                  │                    │                  │                  │
 │                  │                    │  7.返回成功响应   │                  │
 │                  │                    │◄─────────────────┤                  │
 │                  │                    │                  │                  │
 │                  │  8.返回创建结果     │                  │                  │
 │                  │◄───────────────────┤                  │                  │
 │                  │                    │                  │                  │
 │  9.显示成功消息   │                    │                  │                  │
 │◄─────────────────┤                    │                  │                  │
 │                  │                    │                  │                  │
```

**系统操作契约 - createArticle**：

| 契约项 | 内容 |
|--------|------|
| **操作** | createArticle(title, content, summary, categoryId, tagIds) |
| **前置条件** | 用户已认证，title和content不为空 |
| **后置条件** | 1. Article实例被创建<br>2. Article与Category建立关联<br>3. Article与多个Tag建立多对多关联<br>4. Article保存到数据库<br>5. 返回包含新文章ID的响应 |

---

#### 4.2.2 用例：用户登录

**分析类结构**：
- **边界类**：LoginPage（登录页面）
- **控制类**：AuthController（认证控制器）
- **实体类**：User

**系统时序图**：

```
用户      LoginPage    AuthController    AuthService    UserRepository    JwtUtil
 │            │              │                │                │             │
 │ 1.输入凭证  │              │                │                │             │
 ├───────────►│              │                │                │             │
 │            │              │                │                │             │
 │ 2.点击登录  │              │                │                │             │
 ├───────────►│              │                │                │             │
 │            │              │                │                │             │
 │            │  3.登录请求   │                │                │             │
 │            ├─────────────►│                │                │             │
 │            │              │                │                │             │
 │            │              │  4.验证用户     │                │             │
 │            │              ├───────────────►│                │             │
 │            │              │                │                │             │
 │            │              │                │  5.查询用户     │             │
 │            │              │                ├───────────────►│             │
 │            │              │                │                │             │
 │            │              │                │  6.返回用户     │             │
 │            │              │                │◄───────────────┤             │
 │            │              │                │                │             │
 │            │              │                │  7.生成JWT      │             │
 │            │              │                ├────────────────────────────►│
 │            │              │                │                │             │
 │            │              │                │  8.返回token    │             │
 │            │              │                │◄────────────────────────────┤
 │            │              │                │                │             │
 │            │              │  9.返回认证信息 │                │             │
 │            │              │◄───────────────┤                │             │
 │            │              │                │                │             │
 │            │  10.返回结果  │                │                │             │
 │            │◄─────────────┤                │                │             │
 │            │              │                │                │             │
 │ 11.保存token│              │                │                │             │
 │◄───────────┤              │                │                │             │
 │            │              │                │                │             │
```

**系统操作契约 - login**：

| 契约项 | 内容 |
|--------|------|
| **操作** | login(username, password) |
| **前置条件** | 用户已注册 |
| **后置条件** | 1. 验证用户凭证<br>2. 生成JWT令牌<br>3. 返回token、username、role |

---

### 4.3 领域模型类说明

#### 核心类职责

| 类名 | 职责 |
|------|------|
| **User** | 表示系统用户，负责存储用户认证信息和角色 |
| **Info** | 抽象基类，定义所有信息实体的公共属性 |
| **Category** | 表示分类，为所有信息提供分类组织 |
| **Tag** | 表示标签，支持跨类型信息关联 |
| **Article** | 表示文章，继承Info，添加摘要、作者等属性 |
| **Diary** | 表示日记，继承Info，添加心情、天气等属性 |
| **Todo** | 表示待办事项，继承Info，添加状态、优先级等 |

---

## 5. 面向对象设计模型

### 5.1 实体类图（设计层）

**Info抽象基类**：
```java
@Entity
@Inheritance(strategy = InheritanceType.TABLE_PER_CLASS)
public abstract class Info {
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;
    
    private String title;
    
    @Lob
    private String content;
    
    private LocalDateTime createdTime;
    private LocalDateTime updatedTime;
    
    @ManyToOne
    private Category category;
    
    @ManyToMany
    private Set<Tag> tags;
}
```

**Article实体类**：
```java
@Entity
public class Article extends Info {
    private String summary;
    private String author;
    
    @Enumerated(EnumType.STRING)
    private ArticleStatus status;  // DRAFT, PUBLISHED
}
```

### 5.2 系统分层架构

```
┌─────────────────────────────────────────────────────────┐
│                   表示层（Presentation）                  │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │  React组件   │  │  路由管理    │  │  状态管理    │  │
│  └──────────────┘  └──────────────┘  └──────────────┘  │
└────────────────────────┬────────────────────────────────┘
                         │ HTTP/JSON
┌────────────────────────┴────────────────────────────────┐
│                    API层（Controller）                    │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │AuthController│  │ArticleControl│  │  TodoControl │  │
│  └──────────────┘  └──────────────┘  └──────────────┘  │
└────────────────────────┬────────────────────────────────┘
                         │
┌────────────────────────┴────────────────────────────────┐
│                   业务逻辑层（Service）                   │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │  AuthService │  │ArticleService│  │  TodoService │  │
│  └──────────────┘  └──────────────┘  └──────────────┘  │
└────────────────────────┬────────────────────────────────┘
                         │
┌────────────────────────┴────────────────────────────────┐
│                  数据访问层（Repository）                 │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │UserRepository│  │ArticleRepo   │  │  TodoRepo    │  │
│  └──────────────┘  └──────────────┘  └──────────────┘  │
└────────────────────────┬────────────────────────────────┘
                         │ JPA/Hibernate
┌────────────────────────┴────────────────────────────────┐
│                    持久化层（MySQL）                      │
└─────────────────────────────────────────────────────────┘
```

### 5.3 包结构设计

**后端包结构**：
```
com.example.info
├── common          // 通用组件
│   └── ResponseResult.java
├── config          // 配置类
│   ├── CorsConfig.java
│   └── SecurityConfig.java
├── controller      // 控制器层
│   ├── AuthController.java
│   ├── ArticleController.java
│   └── ...
├── dto             // 数据传输对象
│   ├── LoginRequest.java
│   └── AuthResponse.java
├── entity          // 实体类
│   ├── User.java
│   ├── Info.java
│   ├── Article.java
│   └── ...
├── repository      // 数据访问层
│   ├── UserRepository.java
│   └── ArticleRepository.java
├── service         // 业务逻辑层
│   ├── AuthService.java
│   └── ArticleService.java
└── util            // 工具类
    └── JwtUtil.java
```

**前端包结构**：
```
src/
├── api/                // API服务
│   ├── utils/
│   │   ├── apiClient.ts
│   │   └── createCRUDService.ts
│   └── apiServices.ts
├── components/         // 通用组件
│   ├── HomePageComponents/
│   ├── Navigation.tsx
│   └── Modal.tsx
├── pages/             // 页面组件
│   ├── LandingPage/
│   ├── Auth/
│   ├── User/
│   ├── Articles/
│   ├── Common/
│   └── admin/
├── types/             // 类型定义
│   ├── dataTypes.ts
│   ├── uiTypes.ts
│   └── modalTypes.ts
├── hooks/             // 自定义Hook
│   └── useAuth.tsx
├── layouts/           // 布局组件
│   ├── PublicLayout.tsx
│   └── AdminLayout.tsx
└── router/            // 路由配置
    └── index.tsx
```

### 5.4 关键用例设计类图

#### 创建文章用例设计类图

```
┌──────────────────┐       ┌──────────────────┐
│  ArticleEditPage │──────►│ ArticleController│
└──────────────────┘       └────────┬─────────┘
                                    │
                                    ▼
                           ┌────────────────┐
                           │ ArticleService │
                           └────────┬───────┘
                                    │
                    ┌───────────────┼───────────────┐
                    ▼               ▼               ▼
           ┌────────────────┐ ┌────────────┐ ┌────────────┐
           │ArticleRepository│ │CategoryRepo│ │  TagRepo   │
           └────────────────┘ └────────────┘ └────────────┘
```

### 5.5 交互图（时序图）

#### 文章查询场景

```
前端          Controller      Service       Repository      Database
 │                │              │               │               │
 │  GET /articles │              │               │               │
 ├───────────────►│              │               │               │
 │                │              │               │               │
 │                │ findAll()    │               │               │
 │                ├─────────────►│               │               │
 │                │              │               │               │
 │                │              │ findAll(spec) │               │
 │                │              ├──────────────►│               │
 │                │              │               │               │
 │                │              │               │  SELECT *     │
 │                │              │               ├──────────────►│
 │                │              │               │               │
 │                │              │               │  Result Set   │
 │                │              │               │◄──────────────┤
 │                │              │               │               │
 │                │              │  List<Article>│               │
 │                │              │◄──────────────┤               │
 │                │              │               │               │
 │                │ ResponseResult│              │               │
 │                │◄─────────────┤               │               │
 │                │              │               │               │
 │   JSON Data    │              │               │               │
 │◄───────────────┤              │               │               │
 │                │              │               │               │
```

### 5.6 部署视图

```
┌─────────────────────────────────────────────────────────────┐
│                         客户端                                │
│  ┌────────────────────────────────────────────────────────┐ │
│  │          Web浏览器（Chrome/Firefox/Edge）               │ │
│  │          React应用（运行在http://localhost:5173）        │ │
│  └────────────────────────────────────────────────────────┘ │
└──────────────────────────┬──────────────────────────────────┘
                           │ HTTP/HTTPS
┌──────────────────────────┴──────────────────────────────────┐
│                      应用服务器                               │
│  ┌────────────────────────────────────────────────────────┐ │
│  │       Spring Boot内置Tomcat（端口8080）                 │ │
│  │       - RESTful API服务                                 │ │
│  │       - JWT认证                                         │ │
│  │       - 业务逻辑处理                                     │ │
│  └────────────────────────────────────────────────────────┘ │
└──────────────────────────┬──────────────────────────────────┘
                           │ JDBC
┌──────────────────────────┴──────────────────────────────────┐
│                      数据库服务器                             │
│  ┌────────────────────────────────────────────────────────┐ │
│  │          MySQL 8.0（端口3306）                          │ │
│  │          数据库：backwork                                │ │
│  └────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

---

**第2部分完成时间**：2025年10月28日

